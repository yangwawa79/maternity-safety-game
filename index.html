<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>å­•ç”¢å…’å®‰å…¨é‡‘å¹£æŒ‘æˆ°ï½œåƒç´ å°éŠæˆ²</title>
<style>
  :root{
    --bg1:#0f1020; --bg2:#1a1c3a; --card:#223; --accent:#ffd54a; --accent2:#ff9e4a;
    --good:#3ad29f; --bad:#ff5f6d; --text:#eef2ff; --muted:#a7b0c8;
    --pixel:4px; /* åŸºæœ¬åƒç´ å–®ä½ */
  }
  html,body{height:100%;}
  body{
    margin:0; font-family: "Noto Sans TC", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
    color:var(--text);
    background:
      radial-gradient(1200px 800px at 20% -10%, #2a2d63 0%, transparent 60%),
      radial-gradient(800px 600px at 110% 20%, #2c1f52 0%, transparent 55%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
    image-rendering: pixelated;
  }
  .wrap{
    max-width: 980px; margin: 0 auto; padding: 16px 16px 56px; position:relative;
  }
  header{
    display:flex; align-items:center; gap:12px; justify-content:space-between; flex-wrap:wrap;
  }
  .title{
    display:flex; align-items:center; gap:10px; font-weight:900; letter-spacing:1px;
    text-shadow:0 2px 0 rgba(0,0,0,.35);
  }
  .pixel-border{ /* 8-bitæ¡† */
    position:relative; background:var(--card); border:0; padding:10px 12px; border-radius:8px;
    box-shadow: 0 0 0 var(--pixel) #0008, inset 0 0 0 var(--pixel) #0008;
  }
  .hud{display:flex; gap:12px; align-items:center; flex-wrap:wrap;}
  .badge{display:flex; align-items:center; gap:8px; padding:8px 10px; background:#101427; border-radius:10px; box-shadow: inset 0 0 0 var(--pixel) #0008, 0 4px 0 #0006}
  .badge b{font-variant-numeric: tabular-nums;}

  /* è§’è‰²èˆå° */
  .stage{margin-top:16px; display:grid; grid-template-columns: 220px 1fr; gap:16px;}
  .scene{min-height:220px; background:#14183a; border-radius:12px; position:relative; overflow:hidden; box-shadow: inset 0 0 0 var(--pixel) #0008, 0 10px 24px #0008}
  .scene:before{ /* åƒç´ åœ°æ¿ */
    content:""; position:absolute; inset:auto 0 0 0; height:44%;
    background: repeating-linear-gradient(0deg, #191f48 0 8px, #121738 8px 16px);
  }
  .scene .decor{ position:absolute; inset:0; opacity:.25; background:
      radial-gradient(10px 10px at 30% 30%, #fff 0 2px, transparent 3px),
      radial-gradient(12px 12px at 70% 20%, #fff 0 2px, transparent 3px),
      radial-gradient(14px 14px at 50% 60%, #fff 0 2px, transparent 3px);
    filter: blur(0.3px);
  }
  .nurse{ position:absolute; left:36px; bottom:18%; width:120px; height:140px; }
  .nurse svg{ width:100%; height:100%; image-rendering: pixelated; }
  .nurse.bounce{ animation: bob 1.2s infinite ease-in-out; }
  @keyframes bob{ 0%,100%{ transform: translateY(0)} 50%{ transform: translateY(-3px)} }

  /* å•ç­”å¡ */
  .card{ background:#0f1430; border-radius:12px; padding:16px; box-shadow: inset 0 0 0 var(--pixel) #0008, 0 10px 24px #0008}
  .qtext{ font-size:20px; line-height:1.4; margin-bottom:12px; }
  .choices{ display:grid; gap:10px; }
  .btn{
    background:#1a1f45; color:var(--text); border:0; padding:12px; text-align:left; border-radius:10px; cursor:pointer; font-size:16px;
    box-shadow: 0 4px 0 #0006, inset 0 0 0 var(--pixel) #0008; transition: transform .07s ease;
  }
  .btn:hover{ transform: translateY(-1px); }
  .btn:disabled{ opacity:.6; cursor:not-allowed; }
  .btn.correct{ background:#103827; box-shadow: inset 0 0 0 var(--pixel) #0b4833, 0 4px 0 #072d21; }
  .btn.wrong{ background:#3a1720; box-shadow: inset 0 0 0 var(--pixel) #551a25, 0 4px 0 #3a0f17; }

  .feedback{ margin-top:10px; font-size:15px; color:var(--muted); }
  .feedback.ok{ color:var(--good); }
  .feedback.no{ color:var(--bad); }

  .actions{ margin-top:12px; display:flex; gap:10px; }
  .action{ background:linear-gradient(#ffd54a,#ffb84a); color:#231b00; font-weight:700; border:0; padding:10px 14px; border-radius:10px; cursor:pointer; box-shadow: 0 4px 0 #7a4b0a; }
  .action:disabled{ opacity:.6; cursor:not-allowed; }

  /* é‡‘å¹£ / å¯¶ç®± */
  .coin { display:inline-flex; align-items:center; gap:8px; }
  .coin svg{ width:20px; height:20px; vertical-align:-4px; }
  .coin-pop{ position:fixed; pointer-events:none; animation: coinPop 900ms ease forwards; }
  @keyframes coinPop{ 0%{ transform: translateY(0) scale(.8); opacity:0 } 25%{ opacity:1 } 100%{ transform: translateY(-80px) scale(1.05); opacity:0 } }

  .toast{ position:fixed; left:50%; top:18px; transform:translateX(-50%); background:#0c1028; padding:10px 14px; border-radius:10px; box-shadow: 0 6px 0 #0006, inset 0 0 0 var(--pixel) #0008; display:none; }
  .toast.show{ display:block; animation:fPop .4s ease; }
  @keyframes fPop{ from{ transform:translateX(-50%) scale(.9); opacity:0 } to{ transform:translateX(-50%) scale(1); opacity:1 } }

  .chest{ position:absolute; right:12px; bottom:18%; width:80px; height:80px; opacity:0; transform: translateY(6px); transition: all .2s ease; }
  .chest.show{ opacity:1; transform: translateY(0); }

  /* çµç®— */
  dialog{ border:0; border-radius:12px; width:min(560px, 92vw); background:#0d1230; color:var(--text); padding:16px 16px 20px; box-shadow: 0 10px 28px #000a; }
  dialog::backdrop{ background: rgba(0,0,20,.55); }
  .summary h2{ margin:6px 0 8px; }
  .grid-2{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; }

  /* RWD */
  @media (max-width: 840px){
    .stage{ grid-template-columns: 1fr; }
    .nurse{ left:16px; transform: scale(.92); transform-origin: left bottom; }
    .chest{ right:8px; }
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title pixel-border">
        <span style="font-size:20px">ğŸ§‘â€âš•ï¸ğŸ¼</span>
        <div>
          <div style="font-size:18px">å­•ç”¢å…’å®‰å…¨é‡‘å¹£æŒ‘æˆ°</div>
          <small style="color:var(--muted)">å›ç­”é¡Œç›®ã€è³ºé‡‘å¹£ã€å­¸å®‰å…¨ï¼</small>
        </div>
      </div>
      <div class="hud">
        <div class="badge"><span class="coin" id="coinHud"></span><b id="coinCount">0</b></div>
        <div class="badge">ğŸ”¥ é€£æ“Šï¼š<b id="streak">0</b></div>
        <div class="badge">ğŸ“š é¡Œç›®ï¼š<b id="progress">0/0</b></div>
      </div>
    </header>

    <section class="stage">
      <div class="scene pixel-border">
        <div class="decor"></div>
        <!-- åƒç´ è­·å£«è§’è‰²ï¼ˆSVGçŸ©å½¢æ‹¼è²¼ï¼‰ -->
        <div class="nurse bounce" aria-hidden="true">
          <svg viewBox="0 0 64 72" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges">
            <!-- å½±å­ -->
            <rect x="8" y="60" width="48" height="6" fill="#0a0f2a" opacity=".5"/>
            <!-- èº«é«”ç™½è¢ -->
            <rect x="20" y="26" width="24" height="28" fill="#e7f0ff"/>
            <rect x="22" y="28" width="20" height="24" fill="#f8fbff"/>
            <!-- åå­—å¾½ç«  -->
            <rect x="31" y="36" width="2" height="8" fill="#d92c3a"/>
            <rect x="28" y="39" width="8" height="2" fill="#d92c3a"/>
            <!-- é ­éƒ¨è†šè‰² -->
            <rect x="24" y="10" width="16" height="14" fill="#ffd7c2"/>
            <!-- çœ¼ç› -->
            <rect x="28" y="16" width="2" height="2" fill="#1d2b53"/>
            <rect x="34" y="16" width="2" height="2" fill="#1d2b53"/>
            <!-- é ­é«® -->
            <rect x="22" y="8" width="20" height="6" fill="#2b1f3a"/>
            <rect x="22" y="14" width="2" height="10" fill="#2b1f3a"/>
            <rect x="40" y="14" width="2" height="10" fill="#2b1f3a"/>
            <!-- è­·å£«å¸½ -->
            <rect x="22" y="4" width="20" height="6" fill="#ffffff"/>
            <rect x="30" y="5" width="4" height="4" fill="#d92c3a"/>
            <!-- æ‰‹è‡‚ -->
            <rect x="18" y="30" width="6" height="10" fill="#ffd7c2"/>
            <rect x="40" y="30" width="6" height="10" fill="#ffd7c2"/>
            <!-- ä¸‹æ“ºèˆ‡è…¿ -->
            <rect x="20" y="54" width="24" height="4" fill="#c9d7ff"/>
            <rect x="26" y="58" width="4" height="8" fill="#283d70"/>
            <rect x="34" y="58" width="4" height="8" fill="#283d70"/>
            <!-- é‹å­ -->
            <rect x="24" y="66" width="8" height="2" fill="#0b142e"/>
            <rect x="32" y="66" width="8" height="2" fill="#0b142e"/>
          </svg>
        </div>
        <!-- å¯¶ç®± -->
        <div class="chest" id="chest" aria-hidden="true">
          <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges">
            <rect x="8" y="26" width="48" height="28" fill="#8b4f16"/>
            <rect x="10" y="28" width="44" height="24" fill="#aa691f"/>
            <rect x="8" y="22" width="48" height="6" fill="#734011"/>
            <rect x="28" y="22" width="8" height="18" fill="#e2b34a"/>
            <rect x="30" y="34" width="4" height="6" fill="#3b2a0a"/>
          </svg>
        </div>
      </div>
      <div class="card">
        <div class="qtext" id="qtext">æŒ‰ã€Œé–‹å§‹ä½œç­”ã€å–å¾—ç¬¬ä¸€é¡Œ</div>
        <div class="choices" id="choices"></div>
        <div class="feedback" id="feedback"></div>
        <div class="actions">
          <button class="action" id="startBtn">â–¶ é–‹å§‹ä½œç­”</button>
          <button class="action" id="nextBtn" disabled>ä¸‹ä¸€é¡Œ âœ</button>
          <button class="action" id="restartBtn" style="display:none">é‡æ–°é–‹å§‹ â†»</button>
        </div>
      </div>
    </section>
  </div>

  <div class="toast" id="toast">+1 é‡‘å¹£ï¼</div>

  <dialog id="summaryDlg">
    <div class="summary">
      <h2>çµç®—</h2>
      <p id="sumText">åšå¾—å¥½ï¼</p>
      <div class="grid-2">
        <button class="action" id="againBtn">å†ç©ä¸€æ¬¡</button>
        <button class="action" id="shareBtn">è¤‡è£½æˆç¸¾åˆ†äº«</button>
      </div>
    </div>
  </dialog>

<script>
// ===== é¡Œåº«ï¼šå­•ç”¢å…’ç—…äººå®‰å…¨ =====
const QUESTION_BANK = [
  {
    q: "å­•å©¦æ–¼å­•æœŸæ‡‰å®šæœŸç”¢æª¢ï¼Œä¸€èˆ¬å»ºè­°çš„ç”¢æª¢é »ç‡ç‚ºï¼Ÿ",
    options: [
      "æ•´å­•æœŸå…±1~2æ¬¡å³å¯",
      "å‰æœŸæ¯æœˆ1æ¬¡ã€28~36é€±æ¯2é€±1æ¬¡ã€36é€±å¾Œæ¯é€±1æ¬¡",
      "åƒ…æ–¼ä¸èˆ’æœæ™‚å°±é†«",
      "è¦–å€‹äººæ–¹ä¾¿ï¼Œæ²’æœ‰å›ºå®šé »ç‡"
    ],
    a: 1,
    why: "ä¾ä¸€èˆ¬ç”¢æª¢æ™‚ç¨‹ï¼šæ‡·å­•åˆæœŸï½28é€±ç´„æ¯4é€±1æ¬¡ã€28~36é€±æ¯2é€±1æ¬¡ã€36é€±å¾Œæ¯é€±1æ¬¡ã€‚å¯¦éš›ä»ä¾é†«å›‘ã€‚"
  },
  {
    q: "å­•æ—©æœŸè‘‰é…¸è£œå……çš„æœ€ä½³æ™‚æ©Ÿç‚ºï¼Ÿ",
    options: [
      "å—å­•å¾Œ12é€±å¾Œå†é–‹å§‹",
      "å‚™å­•æœŸè‡³å­•æ—©æœŸ(è‡³å°‘å­•å‰1å€‹æœˆåˆ°å­•æ»¿12é€±)",
      "åªåœ¨å­•ä¸­æœŸ",
      "åªè¦é£²é£Ÿæ­£å¸¸ä¸éœ€è£œå……"
    ],
    a: 1,
    why: "è‘‰é…¸å¯é™ä½ç¥ç¶“ç®¡ç¼ºé™·é¢¨éšªï¼Œå»ºè­°å‚™å­•å³é–‹å§‹ï¼Œè‡³å°‘æŒçºŒåˆ°å­•æ»¿12é€±ã€‚"
  },
  {
    q: "ä¸‹åˆ—ä½•è€…å±¬æ–¼å­•æœŸéœ€è¦ç«‹åˆ»å°±é†«çš„å±éšªå¾µè±¡ï¼Ÿ",
    options: [
      "è¼•å¾®å™å¿ƒ",
      "è¦å‰‡æ€§è…¹ç—›ä¼´é™°é“å‡ºè¡€æˆ–ç ´æ°´",
      "é£Ÿæ…¾å¢åŠ ",
      "è¼•åº¦æ°´è…«(ä¼‘æ¯å¯æ”¹å–„)"
    ],
    a: 1,
    why: "è¦å‰‡æ€§è…¹ç—›åŠ å‡ºè¡€/ç ´æ°´å±¬ç·Šæ€¥ç‹€æ³ï¼Œå¯èƒ½æ—©ç”¢ã€èƒç›¤å•é¡Œæˆ–ç ´æ°´ï¼Œéœ€ç«‹å³å°±é†«ã€‚"
  },
  {
    q: "ç”¢å¾Œ48å°æ™‚å…§ï¼Œä½•è€…ç‚ºã€å¤§å‡ºè¡€ã€è­¦è¨Šï¼Ÿ",
    options: [
      "æƒ¡éœ²é‡é€æ¼¸æ¸›å°‘",
      "æ¯1å°æ™‚éœ€æ›´æ›2ç‰‡ä»¥ä¸Šåšå‹è¡›ç”Ÿæ£‰ï¼Œä¼´æšˆçœ©æˆ–å¿ƒæ‚¸",
      "ä¹³æˆ¿æ¼²å¥¶",
      "è¼•å¾®è…¹éƒ¨æ‚¶ç—›"
    ],
    a: 1,
    why: "å¤§é‡å‡ºè¡€ä¸¦ä¼´é ­æšˆå¿ƒæ‚¸ç­‰ä¼‘å…‹ç—‡ç‹€ï¼Œå±¬ç·Šæ€¥è­¦è¨Šã€‚"
  },
  {
    q: "æ–°ç”Ÿå…’å®‰å…¨ç¡çœ ã€ABCã€åŸå‰‡ï¼ŒBä»£è¡¨ï¼Ÿ",
    options: [
      "Blanket(è“‹åšè¢«)",
      "Back(ä»°ç¡)",
      "Bottle(å¥¶ç“¶é™ªç¡)",
      "Buddy(æœ‰äººé™ªç¡)"
    ],
    a: 1,
    why: "ABCï¼šA=Alone(ç¨ç¡åŒæˆ¿ä¸åŒåºŠ)ã€B=Back(ä»°ç¡)ã€C=Crib(å¬°å…’åºŠã€å¹³å¦å …å¯¦)ã€‚"
  },
  {
    q: "æ¯å¬°ã€è‚Œè†šæ¥è§¸ã€çš„å¥½è™•ä¸åŒ…å«å“ªä¸€é …ï¼Ÿ",
    options: [
      "ç©©å®šæ–°ç”Ÿå…’é«”æº«èˆ‡å¿ƒè·³",
      "ä¿ƒé€²æ¯ä¹³åˆ†æ³Œ",
      "å¢åŠ æ„ŸæŸ“é¢¨éšªå¿…ç„¶ä¸Šå‡",
      "å¢é€²è¦ªå­ä¾é™„"
    ],
    a: 2,
    why: "æ­£ç¢ºçš„è‚Œè†šæ¥è§¸å¯ä¿ƒé€²ç©©å®šèˆ‡æ¯ä¹³ï¼›è‹¥é…åˆæ‰‹éƒ¨è¡›ç”Ÿèˆ‡é©ç•¶ç›£æ¸¬ï¼Œä¸æœƒã€å¿…ç„¶ã€å¢åŠ æ„ŸæŸ“ã€‚"
  },
  {
    q: "å¸¶æ–°ç”Ÿå…’å¤–å‡ºï¼Œæ±½åº§ä½¿ç”¨ä½•è€…è¼ƒå®‰å…¨ï¼Ÿ",
    options: [
      "æ–°ç”Ÿå…’å¯æŠ±åœ¨å¤§äººæ‡·è£¡",
      "å¾Œå‘å¼å¬°å…’æ±½åº§ï¼Œä¾èªªæ˜æ­£ç¢ºå®‰è£",
      "åªç”¨å®‰å…¨å¸¶å›ºå®š",
      "çŸ­ç¨‹å°±ä¸éœ€è¦"
    ],
    a: 1,
    why: "å¾Œå‘å¼å¬°å…’æ±½åº§å¯æä¾›é ­é ¸é©ç•¶æ”¯æ’ï¼Œéœ€ä¾èªªæ˜æ­£ç¢ºå®‰è£èˆ‡å›ºå®šã€‚"
  },
  {
    q: "ç…§è­·æ–°ç”Ÿå…’å‰çš„é—œéµæ­¥é©Ÿæ˜¯ï¼Ÿ",
    options: [
      "å…ˆè¦ªå»å¯¶å¯¶",
      "ç”¨é…’ç²¾å™´å…¨èº«",
      "æ­£ç¢ºæ´—æ‰‹/æ‰‹éƒ¨è¡›ç”Ÿ",
      "åªè¦æˆ´æ‰‹å¥—å³å¯"
    ],
    a: 2,
    why: "æ‰‹éƒ¨è¡›ç”Ÿæ˜¯é é˜²æ„ŸæŸ“æœ€é‡è¦ä¸”æœ‰æ•ˆçš„æªæ–½ä¹‹ä¸€ã€‚"
  },
  {
    q: "å­•åª½å’ªè‹¥æ„Ÿè¦ºèƒå‹•æ˜é¡¯æ¸›å°‘ï¼Œå»ºè­°ï¼Ÿ",
    options: [
      "å†è§€å¯Ÿå¹¾å¤©",
      "ç«‹å³ä¼‘æ¯ä¸¦é€²è¡Œèƒå‹•è¨ˆæ•¸ï¼Œè‹¥ä»å°‘æˆ–æœ‰ç–‘æ…®è«‹å°±é†«",
      "å–å«ç³–é£²æ–™å³å¯",
      "ä¸€å®šæ˜¯æ­£å¸¸ç¾è±¡"
    ],
    a: 1,
    why: "èƒå‹•è®Šå°‘å¯èƒ½æ˜¯èƒå…’çª˜è¿«çš„å¾µå…†ï¼Œæ‡‰è©•ä¼°ä¸¦è¦–æƒ…æ³å°±é†«ã€‚"
  },
  {
    q: "æ–°ç”Ÿå…’è‡å¸¶è­·ç†è¼ƒæ°ç•¶çš„æ˜¯ï¼Ÿ",
    options: [
      "ä¿æŒä¹¾ç‡¥æ¸…æ½”ï¼Œå°¿å¸ƒæŠ˜ä¸‹ä¸è¦†è“‹è‡éƒ¨",
      "æ¯å¤©å¡—åšè—¥è†",
      "ç”¨ç²‰æœ«ä¿æŒä¹¾ç‡¥",
      "ç”¨æ‰‹å¸¸å¸¸å»å‰ç—‚"
    ],
    a: 0,
    why: "è‡å¸¶ä¿æŒä¹¾ç‡¥æ¸…æ½”ï¼Œè‡ªç„¶è„«è½å³å¯ï¼Œé¿å…è¦†è“‹èˆ‡éåº¦è™•ç†ã€‚"
  },
  {
    q: "å“ºä¹³ã€é»ƒé‡‘ä¸€å°æ™‚ã€æŒ‡çš„æ˜¯ï¼Ÿ",
    options: [
      "ç”Ÿç”¢å¾Œ1å°æ™‚å…§ç›¡æ—©è¦ªé¤µ",
      "æ¯å¤©å›ºå®šæŸä¸€å°æ™‚é¤µå¥¶",
      "ç”¢å‰1å°æ™‚è£œå……è‘¡è„ç³–",
      "åªé™å‰–è…¹ç”¢é©ç”¨"
    ],
    a: 0,
    why: "æ–¼å‡ºç”Ÿå¾Œ1å°æ™‚å…§é€²è¡Œè‚Œè†šæ¥è§¸ä¸¦å˜—è©¦è¦ªé¤µï¼Œæœ‰åŠ©æˆåŠŸå“ºä¹³èˆ‡ç©©å®šã€‚"
  },
  {
    q: "å­•æ™šæœŸ(35~37é€±)å¸¸è¦‹çš„ç¯©æª¢ç‚ºï¼Ÿ",
    options: [
      "Bå‹è‚ç‚è¡¨é¢æŠ—åŸ",
      "éˆçƒèŒ(GBS)ç¯©æª¢",
      "å¼“æ¼¿èŸ²IgM",
      "å”æ°ç—‡ç¬¬ä¸€å­•æœŸç¯©æª¢"
    ],
    a: 1,
    why: "å¤šæ•¸ç”¢ç§‘æœƒæ–¼35~37é€±é€²è¡ŒBç¾¤éˆçƒèŒ(GBS)ç¯©æª¢ï¼Œé™½æ€§è€…ç”¢æ™‚çµ¦äºˆæŠ—ç”Ÿç´ ä»¥é™ä½æ–°ç”Ÿå…’æ„ŸæŸ“ã€‚"
  },
  {
    q: "æ–°ç”Ÿå…’å®‰å…¨ç¡çœ ä¸å»ºè­°ï¼Ÿ",
    options: [
      "ä½¿ç”¨å¹³å¦å …å¯¦çš„åºŠé¢",
      "èˆ‡å¤§äººåŒåºŠç¡",
      "é¿å…é¬†è»Ÿæ•è¢«èˆ‡ç©å¶",
      "ä»°ç¡å§¿å‹¢"
    ],
    a: 1,
    why: "åŒåºŠå¢åŠ çª’æ¯èˆ‡å£“è¿«é¢¨éšªï¼Œå»ºè­°åŒæˆ¿ä¸åŒåºŠã€‚"
  },
  {
    q: "ç”¢å¾Œå‡ºç¾åŠ‡çƒˆé ­ç—›ã€è¦–åŠ›æ¨¡ç³Šã€èƒ¸ç—›æˆ–å‘¼å¸æ€¥ä¿ƒï¼Œæ‡‰ï¼Ÿ",
    options: [
      "å…ˆç¡ä¸€è¦º",
      "ç«‹å³å°±é†«æˆ–å‘¼å«ç·Šæ€¥æ•‘è­·",
      "å–å’–å•¡ç·©è§£",
      "ç­‰åˆ°å›è¨ºå†èªª"
    ],
    a: 1,
    why: "å¯èƒ½ç‚ºåš´é‡ä½µç™¼ç—‡(å¦‚å­ç™²å‰ç—‡ã€æ “å¡)ï¼Œé ˆç·Šæ€¥è©•ä¼°ã€‚"
  },
  {
    q: "æ—©ç”¢å…’/ä½é«”é‡å…’çš„ã€è¢‹é¼ å¼è­·ç†ã€ä¸»è¦ç›®çš„ï¼Ÿ",
    options: [
      "è®“å¯¶å¯¶æ›´å–œæ­¡è¢«æŠ±",
      "ç©©å®šé«”æº«ã€å¿ƒè·³ä¸¦ä¿ƒé€²å“ºä¹³èˆ‡è¦ªå­ä¾é™„",
      "åªæ˜¯ç‚ºäº†æ‹ç…§",
      "é¿å…å“­é¬§"
    ],
    a: 1,
    why: "è¢‹é¼ å¼è­·ç†(çš®è†šæ¥è§¸)å¯æ”¹å–„ç”Ÿç†ç©©å®šã€æ¸›å°‘æ„ŸæŸ“ã€ä¿ƒé€²è¦ªé¤µèˆ‡ä¾é™„ã€‚"
  },
  {
    q: "å®¶ä¸­å¹«å¯¶å¯¶æ´—æ¾¡æ™‚ï¼Œè¼ƒå®‰å…¨çš„åšæ³•ï¼Ÿ",
    options: [
      "å…ˆå°‡ç†±æ°´èª¿å¥½å¾Œå†æŠ±å¯¶å¯¶é è¿‘ï¼Œæ°´æº«ç´„37~40Â°C",
      "é‚Šæ¥ç†±æ°´é‚ŠæŠŠå¯¶å¯¶æ”¾å…¥",
      "æ°´è¶Šç†±è¶Šèƒ½æ®ºèŒ",
      "åªè¦å¤§äººè¦ºå¾—ä¸ç‡™å°±å¥½"
    ],
    a: 0,
    why: "æ°´æº«å…ˆèª¿å¥½ä¸¦æ¸¬è©¦ï¼Œé¿å…ç‡™å‚·ï¼›ä¿æŒä¸€æ‰‹æ‰¶æŒã€ä¸€æ‰‹æ¸…æ´—ã€‚"
  }
];

// ===== ç‹€æ…‹ =====
let questions = [];
let idx = 0;
let coins = 0;
let streak = 0;
let answered = false;

const qtext = document.getElementById('qtext');
const choicesEl = document.getElementById('choices');
const feedback = document.getElementById('feedback');
const startBtn = document.getElementById('startBtn');
const nextBtn = document.getElementById('nextBtn');
const restartBtn = document.getElementById('restartBtn');
const coinCount = document.getElementById('coinCount');
const streakEl = document.getElementById('streak');
const progressEl = document.getElementById('progress');
const toast = document.getElementById('toast');
const chest = document.getElementById('chest');
const summaryDlg = document.getElementById('summaryDlg');
const sumText = document.getElementById('sumText');
const againBtn = document.getElementById('againBtn');
const shareBtn = document.getElementById('shareBtn');

// HUD: é‡‘å¹£åœ–ç¤º
(function renderCoinHud(){
  const coinHud = document.getElementById('coinHud');
  coinHud.innerHTML = `<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges">
    <circle cx="12" cy="12" r="10" fill="#ffcf33"/>
    <circle cx="12" cy="12" r="8" fill="#ffd95a"/>
    <rect x="11" y="6" width="2" height="12" fill="#ad7b0b"/>
  </svg><span>é‡‘å¹£</span>`;
})();

function shuffle(arr){
  const a = [...arr];
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]] = [a[j],a[i]];
  }
  return a;
}

function startGame(){
  questions = shuffle(QUESTION_BANK).slice(0); // å…¨éƒ¨é¡Œç›®ï¼Œå¯æ”¹ slice(12) å–12é¡Œ
  idx = 0; coins = 0; streak = 0; answered = false;
  coinCount.textContent = coins; streakEl.textContent = streak; progressEl.textContent = `0/${questions.length}`;
  restartBtn.style.display = 'none';
  chest.classList.remove('show');
  renderQuestion();
}

function renderQuestion(){
  if(idx >= questions.length){
    return endGame();
  }
  const {q, options} = questions[idx];
  qtext.textContent = q;
  feedback.textContent = '';
  choicesEl.innerHTML = '';
  answered = false;
  startBtn.disabled = true;
  nextBtn.disabled = true;

  const order = shuffle(options.map((t,i)=>({t,i})));
  for(const {t,i} of order){
    const btn = document.createElement('button');
    btn.className = 'btn';
    btn.textContent = t;
    btn.onclick = ()=>onAnswer(i, btn);
    choicesEl.appendChild(btn);
  }
  progressEl.textContent = `${idx+1}/${questions.length}`;
}

function onAnswer(choiceIndex, btn){
  if(answered) return; answered = true;
  const data = questions[idx];
  const btns = Array.from(choicesEl.querySelectorAll('.btn'));
  btns.forEach(b=>b.disabled = true);

  const correct = choiceIndex === data.a;
  if(correct){
    btn.classList.add('correct');
    coins += 1; streak += 1; coinCount.textContent = coins; streakEl.textContent = streak;
    showToast("+1 é‡‘å¹£ï¼");
    popCoin(btn);
    if(streak>0 && streak%3===0){
      // é€£æ“Šå¯¶ç®±
      coins += 2; coinCount.textContent = coins; showToast("é€£æ“ŠÃ—3ï¼å¯¶ç®±çå‹µ +2 é‡‘å¹£ï¼");
      chest.classList.add('show');
      setTimeout(()=>chest.classList.remove('show'), 1200);
    }
    playBeep(880, 0.08); playBeep(1320, 0.08, 0.09);
    feedback.className='feedback ok';
    feedback.textContent = 'ç­”å°äº†ï¼' + (data.why? 'ã€€' + data.why : '');
  } else {
    btn.classList.add('wrong');
    streak = 0; streakEl.textContent = streak;
    playBeep(200, 0.18);
    feedback.className='feedback no';
    const ansText = data.options[data.a];
    feedback.textContent = `å•Šï¼æ­£ç¢ºç­”æ¡ˆæ˜¯ã€Œ${ansText}ã€ã€‚` + (data.why? 'ã€€' + data.why : '');
  }
  // æ¨™ç¤ºæ­£ç¢ºé¸é …
  btns.forEach((b,k)=>{
    const originalIndex = data.options.indexOf(b.textContent);
    if(originalIndex === data.a){ b.classList.add('correct'); }
  });

  nextBtn.disabled = false;
}

function nextQuestion(){ idx++; renderQuestion(); }

function endGame(){
  qtext.textContent = 'å¤ªæ£’äº†ï¼æ‰€æœ‰é¡Œç›®å®Œæˆã€‚';
  choicesEl.innerHTML = '';
  feedback.textContent = '';
  nextBtn.disabled = true;
  restartBtn.style.display = '';
  const star = 'â­';
  const medal = coins>=questions.length+Math.floor(questions.length/3)? 'ğŸ…' : (coins>=Math.floor(questions.length*0.7)? 'ğŸ–ï¸':'ğŸ—ï¸');
  sumText.textContent = `${medal} æœ¬æ¬¡ç²å¾— ${coins} é‡‘å¹£ï¼å…± ${questions.length} é¡Œã€‚é€£æ“Šæœ€é«˜ ${getMaxStreak()}ï¼`;
  summaryDlg.showModal();
}

function getMaxStreak(){
  // ç°¡æ˜“ï¼šæ ¹æ“š coins ç²—ç•¥åæ¨(éç²¾æº–è¨˜éŒ„)ã€‚æ­¤è™•å¯æ“´å……æ­·å²è¨˜éŒ„ã€‚
  // å…ˆå›å‚³ç¾åœ¨çš„ streakï¼ˆæ”¶å°¾æ™‚å¤šç‚º 0ï¼‰ï¼Œç”¨è¿‘ä¼¼ï¼š
  return streak; // è‹¥è¦ç²¾æº–ï¼Œéœ€åœ¨ onAnswer ä¸­è¿½è¹¤ maxStreakã€‚
}

// ===== è¦–è¦º & UX =====
function popCoin(fromBtn){
  const r = fromBtn.getBoundingClientRect();
  const c = document.createElement('div');
  c.className='coin-pop';
  c.style.left = (r.left + r.width - 20) + 'px';
  c.style.top = (r.top - 8 + window.scrollY) + 'px';
  c.innerHTML = `<svg viewBox="0 0 24 24" width="24" height="24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" fill="#ffcf33"/><circle cx="12" cy="12" r="8" fill="#ffd95a"/><rect x="11" y="6" width="2" height="12" fill="#ad7b0b"/></svg>`;
  document.body.appendChild(c);
  setTimeout(()=>c.remove(), 900);
}

function showToast(msg){
  toast.textContent = msg; toast.classList.add('show');
  setTimeout(()=>toast.classList.remove('show'), 1000);
}

// éŸ³æ•ˆï¼šWebAudio ç°¡æ˜“æç¤ºéŸ³
let audioCtx;
function playBeep(freq=440, dur=0.1, delay=0){
  if(!audioCtx) audioCtx = new (window.AudioContext||window.webkitAudioContext)();
  const t0 = audioCtx.currentTime + (delay||0);
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.frequency.value = freq; osc.type = 'square';
  gain.gain.setValueAtTime(0.0001, t0);
  gain.gain.exponentialRampToValueAtTime(0.2, t0+0.01);
  gain.gain.exponentialRampToValueAtTime(0.0001, t0+dur);
  osc.connect(gain).connect(audioCtx.destination);
  osc.start(t0); osc.stop(t0+dur+0.02);
}

// ===== äº‹ä»¶ =====
startBtn.addEventListener('click', startGame);
nextBtn.addEventListener('click', nextQuestion);
restartBtn.addEventListener('click', startGame);
againBtn.addEventListener('click', ()=>{ summaryDlg.close(); startGame(); });
shareBtn.addEventListener('click', async ()=>{
  const total = questions.length; const txt = `æˆ‘åœ¨ã€Œå­•ç”¢å…’å®‰å…¨é‡‘å¹£æŒ‘æˆ°ã€å¾—åˆ° ${coins} é‡‘å¹£ï¼${total} é¡Œï¼ä¾†æŒ‘æˆ°å§ï½`;
  try{
    await navigator.clipboard.writeText(txt);
    showToast('å·²è¤‡è£½æˆç¸¾ï¼');
  }catch(e){ alert(txt); }
});

// åˆå§‹ï¼šæ¸²æŸ“ä¸€å€‹æç¤º
choicesEl.innerHTML = `<button class="btn" disabled>æŒ‰ä¸Šæ–¹ã€Œé–‹å§‹ä½œç­”ã€é–‹å§‹</button>`;

</script>
</body>
</html>
